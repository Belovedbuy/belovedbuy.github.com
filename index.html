<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>BelovedBuy - Tech Picks</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>BelovedBuy - Best Tech Deals</h1>
    <p>Top-rated tech gadgets just for you</p>
  </header>

  <div class="search-section">
    <input type="text" id="searchBox" placeholder="Search tech products...">
    <ul id="resultsList"></ul>
  </div>

  <div class="add-product-section">
    <button class="add-product-btn" onclick="showPasswordModal()">+ Add Product</button>
  </div>

  <div class="password-modal" id="passwordModal">
    <div class="modal-content">
      <h2>Enter Password</h2>
      <input type="password" id="passwordInput" placeholder="Enter password">
      <button onclick="checkPassword()">Submit</button>
    </div>
  </div>

  <div id="productForm" class="add-product-form">
    <input type="text" id="productTitle" placeholder="Product Title">
    <input type="text" id="productImage" placeholder="Image URL">
    <textarea id="productDescription" placeholder="Product Description"></textarea>
    <input type="text" id="productPrice" placeholder="Product Price">
    <input type="text" id="productRating" placeholder="Product Rating">
    <input type="text" id="productLink" placeholder="Amazon Product Link">
    <textarea id="productExplanation" placeholder="Product Explanation"></textarea>
    <button onclick="addProduct()">✅ Add to Page</button>
  </div>

  <section class="product-list" id="productList">
    <!-- Existing products -->
    <!-- These will be dynamically loaded from products.json -->
  </section>

  <footer>
    <p>&copy; 2025 BelovedBuy. All rights reserved.</p>
  </footer>

  <script>
    // Load products from products.json
    async function loadProducts() {
      try {
        const response = await fetch('products.json');
        const products = await response.json();
        
        products.forEach(product => {
          const productCard = document.createElement('div');
          productCard.className = 'product-card';
          productCard.id = product.id;
          
          productCard.innerHTML = `
            <img src="${product.image}" alt="${product.title}">
            <div class="product-info">
              <h2>${product.title}</h2>
              <p>Price: <strong>${product.price}</strong></p>
              <p>Rating: ⭐ ${product.rating}</p>
              <p>${product.description}</p>
              <a href="${product.link}" class="view-product" target="_blank">View Product</a>
              <button class="delete-btn" onclick="attemptDelete('${product.id}')">Delete Product</button>
            </div>
          `;
          
          document.getElementById('productList').appendChild(productCard);
        });
        
        // Check if authorized and show delete buttons
        if (sessionStorage.getItem('authorized') === 'true') {
          document.querySelectorAll('.delete-btn').forEach(button => {
            button.style.display = 'flex';
          });
          document.getElementById('productForm').style.display = 'block';
        }
      } catch (error) {
        console.error('Error loading products:', error);
      }
    }

    // Show password modal
    function showPasswordModal() {
      document.getElementById('passwordModal').style.display = 'flex';
    }

    // Check password
    function checkPassword() {
      const password = document.getElementById('passwordInput').value;
      if (password === '20071961Bc@') {
        sessionStorage.setItem('authorized', 'true');
        document.getElementById('passwordModal').style.display = 'none';
        
        // Show delete buttons for all existing products
        document.querySelectorAll('.delete-btn').forEach(button => {
          button.style.display = 'flex';
        });
        
        // Show the add product form
        document.getElementById('productForm').style.display = 'block';
      } else {
        alert('Incorrect password!');
      }
    }

    // Add a new product
    function addProduct() {
      const t = document.getElementById('productTitle').value.trim(),
            i = document.getElementById('productImage').value.trim(),
            d = document.getElementById('productDescription').value.trim(),
            pr = document.getElementById('productPrice').value.trim(),
            rt = document.getElementById('productRating').value.trim(),
            l = document.getElementById('productLink').value.trim(),
            exp = document.getElementById('productExplanation').value.trim();
      
      if (!t || !i || !d || !pr || !rt || !l || !exp) {
        return alert('Please fill in all fields!');
      }
      
      const id = 'prod_' + Date.now();
      
      // Create new product card
      const productCard = document.createElement('div');
      productCard.className = 'product-card';
      productCard.id = id;
      
      productCard.innerHTML = `
        <img src="${i}" alt="${t}">
        <div class="product-info">
          <h2>${t}</h2>
          <p>Price: <strong>${pr}</strong></p>
          <p>Rating: ⭐ ${rt}</p>
          <p>${d}</p>
          <a href="${l}" class="view-product" target="_blank">View Product</a>
          <button class="delete-btn" onclick="attemptDelete('${id}')">Delete Product</button>
        </div>
      `;
      
      document.getElementById('productList').appendChild(productCard);
      
      // Reset the form
      document.getElementById('productForm').reset();
      
      // Scroll to the top of the page
      window.scrollTo(0, 0);
      
      // Here you would typically save the new product to your products.json file
      // This requires a backend service which is beyond the scope of this example
      alert('Product added successfully! Note: To persist this product, you need to add it to products.json manually or implement a backend service.');
    }

    // Attempt to delete a product
    function attemptDelete(id) {
      const password = prompt('Enter password to delete:');
      if (password === '20071961Bc@') {
        document.getElementById(id).remove();
        
        // Here you would typically remove the product from your products.json file
        // This requires a backend service which is beyond the scope of this example
        alert('Product deleted successfully! Note: To permanently delete this product, you need to remove it from products.json manually or implement a backend service.');
      } else {
        alert('Incorrect password!');
      }
    }

    // Initialize the page
    document.addEventListener('DOMContentLoaded', loadProducts);
  </script>
</body>
</html>
